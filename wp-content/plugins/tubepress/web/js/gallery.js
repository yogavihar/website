/*!
 * Copyright 2006 - 2015 TubePress LLC (http://tubepress.com).
 * This file is part of TubePress (http://tubepress.com).
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 */
;var tubePressGalleryRegistrar;(function(J){var e="tubepress",k="gallery",c="item",z=".",R="_",K="-",n="#",O=" ",X="player",l="Id",T="id",f="params",A="sys",r="js",s="div",q="fluid",g="class",F=q+"Thumbs",b="html",G="thumb",u="length",L=G+"s",i=r+K,v=e+K,h=k+l,y=c+l,E=z+i,t=R+k+R,B=e+z+k+z,H=B+"load",W=B+"new"+L,N=B+c+z+"change",I=B+X+z,d=I+"populate"+z,m=I+"invoke"+z,V=J.Beacon,j=V.subscribe,p=V.publish,P=J.Lang.Utils,w=P.isDefined,Q=J.Environment,a=true,S=false,D=J.Vendors.jQuery,C=(function(){var ac={},ae={},ad=function(ag){return n+e+t+ag},aa=function(ag){return E+v+k+K+ag},Z=function(aj){if(P.isDefined(ac[aj])){return ac[aj]}var ag=ad(aj),ai=aa(aj),ah=D(ag).add(ai);if(ah.length>0){ac[aj]=ah}return ah},af=function(ag){return aa(ag)+O+E+v+"pagination-and-"+L},ab=function(ag){return n+e+t+ag+"_thumbnail_area"},Y=function(ag){if(!P.isDefined(ae[ag])){ae[ag]=D(ab(ag)).add(af(ag))}return ae[ag]};return{getOutermostElement:Z,getOutermostSelectorLegacy:ad,getOutermostSelectorModern:aa,getThumbAreaSelectorLegacy:ab,getThumbAreaSelectorModern:af,getThumbAreaElement:Y}}()),M=(function(){var Z=D.data,aa=function(ac){return C.getOutermostElement(ac)},Y=function(ad,ac){return Z(aa(ad),ac)},ab=function(ad,ac,ae){Z(aa(ad),ac,ae)};return{get:Y,set:ab}}()),x=(function(){var ae="options",ad="ephemeral",ab=D.isPlainObject,af=function(ai,ah){var ag=M.get(ai,f);if(ag===""||!ab(ag)||!w(ag[ah])||!ab(ag[ah])){return{}}return ag[ah]},aa=function(ak,aj,ai,ag){var ah=af(ak,aj);return w(ah[ai])?ah[ai]:ag},ac=function(ai,ah,ag){return aa(ai,ae,ah,ag)},Y=function(ag){return af(ag,ad)},Z=function(ai,aj){var ah=aj[h],ag=aj[f];M.set(ah,f,ag)};j(H,Z);return{getOption:ac,getEphemeralOptions:Y}}()),U=(function(){var aa={},Y=function(ad,ac){var ab=ac[h];aa[ab]=ac[f]},Z=function(){return D.extend(true,{},aa)};j(H,Y);return{getAll:Z}}()),o=(function(){var Y=function(aa,ab){var Z={};Z[h]=aa;Z[f]=ab;p(H,Z)};return{register:Y}}());(function(){var Y=function(ab,aa){var Z=aa[h];M.set(Z,T,Z)};j(H,Y)}());(function(){var Y=[],ah=Math.floor,ag="first",aa="100%",ab="width",aj="px",Z=function(al,ak){return ak.indexOf(al,ak[u]-al[u])!==-1},af=function(ak){var al=ak.css(ab);if(al&&Z(aj,al)){return al.replace(aj,"")}return ak.width()},ae=function(ao){var am=C.getOutermostSelectorModern(ao)+O+E+v+q+K+G+K+"reference:"+ag,ap=D(am),al,ak,an;if(ap[u]>0){return af(ap)}al=C.getThumbAreaElement(ao);ak=al.find("img:"+ag);an=120;if(ak[u]===0){ak=al.find(s+z+e+R+G+":"+ag+" > "+s+z+e+"_embed");if(ak[u]===0){return an}}return af(ak)},ad=function(au){C.getThumbAreaElement(au).css({width:aa});var al=ae(au),av=C.getThumbAreaElement(au),ao=av.width(),ak=ah(ao/al),ap=ah(ao/ak),ar=z+e+R+G,am=E+v+q+K+G+K+"adjustable",aq=av.find(am).add(av.find(ar)),at={},an={};an[ab]=aa;av.css(an);an[ab]=ao;av.css(an);an[ab]=ap;aq.css(an);av.data(q+R+L+"_applied",a);at[h]=au;at.newThumbWidth=ap;p(B+F,at)},ac=function(am,al){var ak=al[h];if(x.getOption(ak,F,S)){if(D.inArray(ak,Y)===-1){Y.push(ak)}ad(ak)}},ai=function(an){var ak=0,al=Y[u],am={};for(ak;ak<al;ak+=1){am[h]=Y[ak];ac(an,am)}};j(W+O+H,ac);j(e+".window.resize",ai)}());(function(){var aa=function(ac){return ac[3]},Y=function(ad){var ac=ad.lastIndexOf(R);return ad.substring(16,ac)},Z=function(){var ac=D(this).attr("rel").split(R),ae=Y(D(this).attr(T)),ad={};ad[h]=aa(ac);ad[y]=ae;p(N,ad)},ab=function(ad,ac){D(n+e+t+ac[h]+" a[id^='"+e+"_']").click(Z)};j(W+O+H,ab)}());(function(){var aa=function(ad,ae){var ac=ad.attr(g).split(/\s+/),ab=0;for(ab;ab<ac[u];ab+=1){if(ac[ab].indexOf(ae)===0){return ac[ab].replace(ae,"")}}return null},Z=function(ad){var ac=D(ad.currentTarget),ae=aa(ac,i+v+c+T+K),ab={};ab[h]=D.data(this,T);ab[y]=ae;p(N,ab)},Y=function(af,ae){var ad=ae[h],ab=C.getOutermostSelectorModern(ad),ac=C.getOutermostElement(ad);D(ab).on("click",E+v+"invoker",D.proxy(Z,ac))};j(H,Y)}());(function(){var Y=function(ad,ab){var ai=ab[h],af=ab[y],aa=x.getOption(ai,X+"Location","?"),ae="mediaItem",ag=function(ak){var aj={};aj[ae]=ak[ae];aj[b]=ak[b];aj[h]=ai;aj[y]=af;p(d+aa,aj)},ac={},Z,ah={};ac[e+R+"action"]=X+"Html";ac[e+R+c]=af;ac[e+R+"options"]=x.getEphemeralOptions(ai);ah[y]=af;ah[h]=ai;p(m+aa,ah);Z=x.getOption(ai,"httpMethod","GET");D.ajax({data:ac,dataType:"json",success:ag,type:Z,url:Q.getAjaxEndpointUrl()})};j(N,Y)}());J.AsyncUtil.processQueueCalls("tubePressGalleryRegistrar",o);J.Gallery={Registry:U,Selectors:C,Options:x};J.Beacon.publish(e+z+r+z+A+z+k)}(TubePress));